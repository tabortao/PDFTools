# AI API Client

API Client是一个用于调用文本生成API的.NET 8命令行工具，支持纯文本响应。

## 功能特性

- 支持API端点URL参数
- 处理prompt、text、model三个核心参数
- 支持API密钥认证
- 自动转义JSON特殊字符
- 详细的错误处理和调试信息
- 友好的命令行界面

## 安装与使用

### 1. 构建项目
```bash
dotnet build
```

### 2. 运行程序
```bash
# 基本用法（无API密钥）
dotnet run -- <apiUrl> <prompt> <text> <model>

# 带API密钥用法
dotnet run -- <apiUrl> <prompt> <text> <model> <apiKey>
```

### 3. 使用示例
```bash
# 翻译示例
dotnet run -- "http://localhost:8080/api/v1/generate" "请将以下文本翻译成英语：" "你好，我的祖国是中国！" "gpt-4o"

# 带API密钥的示例
dotnet run -- "http://localhost:8080/api/v1/generate" "总结以下文本：" "人工智能是未来发展的关键领域" "gpt-4o" sk-1234567890
```

## 参数说明

| 参数    | 说明                                  | 示例值                                      |
|---------|---------------------------------------|---------------------------------------------|
| apiUrl  | API端点URL                            | `http://localhost:8080/api/v1/generate`   |
| prompt  | 提示文本                              | `"请将以下文本翻译成英语："`                |
| text    | 需要处理的文本                        | `"你好，世界！"`                            |
| model   | 使用的AI模型名称                      | `"gpt-4o"`                               |
| apiKey  | (可选) API认证密钥                    | `sk-1234567890`                             |

## 技术细节

### 请求格式
程序会发送以下JSON格式的请求：
```json
{
  "prompt": "用户提供的提示",
  "text": "需要处理的文本",
  "model": "指定的模型名称"
}
```

### 响应处理
- 直接返回API响应的原始字符串内容
- 非200状态码会返回详细的错误信息
- 网络错误会提供明确的诊断信息

### 特殊字符处理
程序会自动转义以下特殊字符：
- 双引号 `"` → `\"`
- 反斜杠 `\` → `\\`
- 换行符 `\n` → `\\n`
- 回车符 `\r` → `\\r`
- 制表符 `\t` → `\\t`

## 错误处理

程序会捕获并显示以下错误类型：
- HTTP错误（非200响应）
- 网络连接问题
- JSON格式错误
- 参数验证错误
- 其他运行时异常

## 常见问题

### Q1: 如何解决连接超时问题？
A: 检查网络连接，确保API端点可访问，或增加超时时间（修改代码中的Timeout值）

### Q2: API返回非预期内容怎么办？
A: 检查API文档确认请求格式，验证模型名称是否正确

### Q3: 如何处理包含特殊字符的文本？
A: 程序会自动转义特殊字符，但建议使用英文双引号包裹参数

## 许可证
MIT License - 自由使用和修改

## 项目说明

### 核心设计

1. **模块化架构**：
   - `AIGenerateClient` 类封装所有API交互逻辑
   - `Program` 类处理命令行参数和用户交互

2. **健壮的输入处理**：
   - 手动构建JSON请求确保格式正确
   - 特殊字符转义防止JSON解析错误
   - API密钥掩码显示保护敏感信息

3. **全面的错误处理**：
   - HTTP状态码检查
   - 网络异常捕获
   - 详细的错误消息

4. **用户友好界面**：
   - 清晰的参数说明
   - 请求/响应分隔显示
   - 进度提示

### 使用示例

```bash
# 构建项目
dotnet build

# 运行翻译示例
dotnet run -- "https://localhost:8080/api/v1/generate" "请将以下文本翻译成英语：" "你好，我的祖国是中国！" "gpt-4o"

# 带API密钥的创作请求
dotnet run -- "http://localhost:8080/api/v1/generate" "根据以下主题写一首诗：" "春天的花园" "gpt-4o" sk-1234567890
```

